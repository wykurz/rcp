# nextest configuration for rcp
# https://nexte.st/book/configuration.html

[profile.default]
# allow most tests to run in parallel
test-threads = 32

[test-groups]
# serial execution for remote tests that use SSH to localhost
serial = { max-threads = 1 }

# remote tests that use localhost SSH must run serially to avoid connection conflicts
[[profile.default.overrides]]
filter = 'test(remote)'
test-group = 'serial'

# docker tests must run serially to avoid port/connection conflicts.
# binary(~docker) uses regex matching: ~ means "contains", so this matches any
# test binary with "docker" in its name (e.g., docker_multi_host, docker_chaos_network).
[[profile.default.overrides]]
filter = 'binary(~docker)'
test-group = 'serial'

[profile.docker]
# docker profile runs Docker integration tests (multi-host and chaos tests)
# these tests are normally ignored and require Docker containers
default-filter = 'binary(~docker)'
